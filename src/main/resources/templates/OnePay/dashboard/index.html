<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <!--Title-->
    <title>OnePay Dashboard</title>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="telephone=no" name="format-detection">

    <!-- MOBILE SPECIFIC -->
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <!-- Favicon icon -->
    <link rel="icon" sizes="16x16" th:href="@{/dashboardassets/images/favicon.png}" type="image/png">
    <link rel="stylesheet" th:href="@{/dashboardassets/vendor/jqvmap/css/jqvmap.min.css}">
    <link rel="stylesheet" th:href="@{/dashboardassets/vendor/chartist/css/chartist.min.css}">

    <!-- Vectormap -->
    <link rel="stylesheet" th:href="@{/dashboardassets/vendor/jqvmap/css/jqvmap.min.css}">
    <link rel="stylesheet" th:href="@{/dashboardassets/vendor/bootstrap-select/dist/css/bootstrap-select.min.css}">
    <link rel="stylesheet" th:href="@{/dashboardassets/vendor/owl-carousel/owl.carousel.css}">
    <link class="main-css" rel="stylesheet" th:href="@{/dashboardassets/css/style.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js">

</head>


<body>

<!--*******************
    Preloader start
********************-->
<div id="preloader">
    <div class="sk-three-bounce">
        <div class="sk-child sk-bounce1"></div>
        <div class="sk-child sk-bounce2"></div>
        <div class="sk-child sk-bounce3"></div>
    </div>
</div>
<!--*******************
    Preloader end
********************-->

<!--**********************************
    Main wrapper start
***********************************-->
<div id="main-wrapper">

    <!--**********************************
        Nav header start
    ***********************************-->
    <div class="nav-header">
        <a class="brand-logo" href="/OnePay/dashboard/index">
            <img alt="" class="logo-abbr" src="/assets/images/logo-wallet.png">
            <img alt="" class="logo-compact" src="/assets/images/logo-word.png">
            <img alt="" class="brand-title" src="/assets/images/logo-word.png">
        </a>

        <div class="nav-control">
            <div class="hamburger">
                <span class="line"></span><span class="line"></span><span class="line"></span>
            </div>
        </div>
    </div>
    <!--**********************************
        Nav header end
    ***********************************-->


    <!--**********************************
        Header start
    ***********************************-->
    <div class="header">
        <div class="header-content">
            <nav class="navbar navbar-expand">
                <div class="collapse navbar-collapse justify-content-between">
                    <div class="header-left">
                        <div class="dashboard_bar">
                            <div class="input-group search-area d-lg-inline-flex d-none">
                            </div>
                        </div>
                    </div>
                    <ul class="navbar-nav header-right">
                        <li class="nav-item">
                            <div class="d-flex weather-detail">
<!--                        <li><div>-->
                                <span><i class="fa-solid fa-cloud"></i>32Â°C</span>
                                Singapore
                            </div>
                        </li>
<!--                        <div>-->
<!--                            <li class="nav-item dropdown notification_dropdown">-->
<!--                                <a class="nav-link bell dz-theme-mode" href="javascript:void(0);">-->
<!--                                    <i id="icon-light" class="fas fa-sun"></i>-->
<!--                                    <i id="icon-dark" class="fas fa-moon"></i>-->
<!--                                </a>-->
<!--                            </li>-->
<!--                        </div>-->

                        <li class="nav-item dropdown notification_dropdown">
                            <a class="nav-link  ai-icon" data-bs-toggle="dropdown" href="javascript:void(0)"
                               role="button">
                                <svg fill="none" height="20" viewBox="0 0 28 28" width="20"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path clip-rule="evenodd"
                                          d="M12.6001 4.3008V1.4C12.6001 0.627199 13.2273 0 14.0001 0C14.7715 0 15.4001 0.627199 15.4001 1.4V4.3008C17.4805 4.6004 19.4251 5.56639 20.9287 7.06999C22.7669 8.90819 23.8001 11.4016 23.8001 14V19.2696L24.9327 21.5348C25.4745 22.6198 25.4171 23.9078 24.7787 24.9396C24.1417 25.9714 23.0147 26.6 21.8023 26.6H15.4001C15.4001 27.3728 14.7715 28 14.0001 28C13.2273 28 12.6001 27.3728 12.6001 26.6H6.19791C4.98411 26.6 3.85714 25.9714 3.22014 24.9396C2.58174 23.9078 2.52433 22.6198 3.06753 21.5348L4.20011 19.2696V14C4.20011 11.4016 5.23194 8.90819 7.07013 7.06999C8.57513 5.56639 10.5183 4.6004 12.6001 4.3008ZM14.0001 6.99998C12.1423 6.99998 10.3629 7.73779 9.04973 9.05099C7.73653 10.3628 7.00011 12.1436 7.00011 14V19.6C7.00011 19.817 6.94833 20.0312 6.85173 20.2258C6.85173 20.2258 6.22871 21.4718 5.57072 22.7864C5.46292 23.0034 5.47412 23.2624 5.60152 23.4682C5.72892 23.674 5.95431 23.8 6.19791 23.8H21.8023C22.0445 23.8 22.2699 23.674 22.3973 23.4682C22.5247 23.2624 22.5359 23.0034 22.4281 22.7864C21.7701 21.4718 21.1471 20.2258 21.1471 20.2258C21.0505 20.0312 21.0001 19.817 21.0001 19.6V14C21.0001 12.1436 20.2623 10.3628 18.9491 9.05099C17.6359 7.73779 15.8565 6.99998 14.0001 6.99998Z"
                                          fill="#3E4954"
                                          fill-rule="evenodd"/>
                                </svg>
                            </a>
                            <div class="dropdown-menu dropdown-menu-end">
                                <div class="widget-media dz-scroll p-3 justify-content-center align-items-center" id="DZ_W_Notification1">
                                    <div>
                                        Empty notification.
                                    </div>
                                </div>
                                <a class="all-notification" >See all notifications <i class="ti-arrow-right"></i></a>
                            </div>
                        </li>

                        <li class="nav-item dropdown header-profile">
                            <a class="nav-link" data-bs-toggle="dropdown" href="javascript:void(0)" role="button">
                                <div class="header-info">
                                    <span class="text-black">Hello, <strong id="username" th:text="${#strings.capitalize(username.toLowerCase())}">Franklin</strong></span>
                                    <p class="fs-12 mb-0">Normal User</p>
                                </div>
                                <img alt="" src="/dashboardassets/images/profile/17.jpg" width="20">
                            </a>
                            <div class="dropdown-menu dropdown-menu-end">
                                <a class="dropdown-item ai-icon" href="/OnePay/dashboard/account-details">
                                    <svg class="text-primary" fill="none" height="18"
                                         id="icon-user1" stroke="currentColor" stroke-linecap="round"
                                         stroke-linejoin="round" stroke-width="2"
                                         viewBox="0 0 24 24" width="18" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="12" cy="7" r="4"></circle>
                                    </svg>
                                    <span class="ms-2">Account </span>
                                </a>
                                <a class="dropdown-item ai-icon" href="/OnePay/home">
                                    <svg class="text-danger" fill="none" height="18"
                                         id="icon-logout" stroke="currentColor" stroke-linecap="round"
                                         stroke-linejoin="round" stroke-width="2"
                                         viewBox="0 0 24 24" width="18" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                        <polyline points="16 17 21 12 16 7"></polyline>
                                        <line x1="21" x2="9" y1="12" y2="12"></line>
                                    </svg>
                                    <span class="ms-2">Logout</span>
                                </a>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
    </div>
    <!--**********************************
        Header end ti-comment-alt
    ***********************************-->

    <!--**********************************
        Sidebar start
    ***********************************-->
    <div class="deznav">
        <div class="deznav-scroll">
            <ul class="metismenu" id="menu">


                <li>
                    <a href="/OnePay/dashboard/index">
                        <i class=" fas fa-th-large" ></i>
                        <span class="nav-text align-content-center " style="cursor: pointer; color: var(--primary);">Dashboard</span>
                    </a>
                </li>



                <li>
                    <a aria-expanded="false" href="javascript:void(0);" data-bs-toggle="collapse" data-bs-target="#walletSubmenu" aria-controls="walletSubmenu"  style="display: flex; justify-content: space-between; align-items: center;">
                        <i class="fas fa-wallet"></i>
                        <span class="nav-text">My Wallet</span>
                        <i class="fas fa-chevron-right dropdown-chevron" style="float:right;"></i>
                    </a>

                    <!-- Submenu (collapsed by default) -->
                    <ul class="collapse" id="walletSubmenu">
                        <li><a href="/OnePay/dashboard/wallet-details">Wallet Details</a></li>
                        <li><a href="/OnePay/dashboard/wallet-history">Wallet History</a></li>
                        <!-- about top-up/withdraw history-->
                    </ul>
                </li>


                <li>
                    <a aria-expanded="false" href="javascript:void(0);" data-bs-toggle="collapse" data-bs-target="#transferSubmenu" aria-controls="transferSubmenu" style="display: flex; justify-content: space-between; align-items: center;">
                        <i class="fa-solid fa-money-bill-alt"></i>
                        <span class="nav-text">Transfer</span>
                        <i class="fas fa-chevron-right dropdown-chevron" style="float:right;"></i> <!-- Chevron for the dropdown arrow -->
                    </a>
                    <!-- Submenu (collapsed by default) -->
                    <ul class="collapse" id="transferSubmenu">
                        <li><a href="/OnePay/dashboard/moneytransfer">Money Transfer</a></li>
                        <li><a href="/OnePay/dashboard/transfer-history">Transfer History</a></li>
                    </ul>
                </li>

                <li>
                    <a aria-expanded="false" href="javascript:void(0);" data-bs-toggle="collapse" data-bs-target="#accountSubmenu" aria-controls="accountSubmenu" style="display: flex; justify-content: space-between; align-items: center;">
                        <i class="fa-regular fa-user"></i>
                        <span class="nav-text">Account</span>
                        <i class="fas fa-chevron-right dropdown-chevron" style="float:right;"></i>
                    </a>
                    <!-- Submenu (collapsed by default) -->
                    <ul class="collapse" id="accountSubmenu">
                        <li><a href="/OnePay/dashboard/account-details">Account Details</a></li>
                        <li><a href="/OnePay/dashboard/settings">Settings</a></li>
                        <li><a href="/OnePay/dashboard/activity-history">Activity History</a></li>
                        <li><a href="/OnePay/dashboard/terms&conditions">Terms & Conditions</a></li>
                    </ul>
                </li>

                <li>
                    <a class="submenu-icon" href="/OnePay/home" >
                        <i class=" fas fa-sign-out-alt" ></i>
                        <span class="nav-text align-content-center" >Log Out</span>
                    </a>
                </li>

                <div class="copyright copyright-style">
                    <p><strong>OnePay Payment Dashboard</strong> Â© 2024 All Rights Reserved</p>
                    <p>Made with <span class="heart"></span> by FYP-24-S3-14</p>
                </div>
            </ul>
        </div>
    </div>
    <!--**********************************
        Sidebar end
    ***********************************-->

    <!--**********************************
        Content body start
    ***********************************-->
    <div class="content-body default-height">
        <!-- row -->
        <div class="container-fluid">
            <div class="form-head mb-4">
                <h2 class="text-black font-w600 mb-0">Dashboard</h2>
            </div>
            <div class="row">
                <div class="col-xl-6">
                    <div class="row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                            <div class="card-bx stacked">
                                <img src="/dashboardassets/images/card/card.jpg" alt="" class="mw-100">
                                <div class="card-info text-white">
                                    <p class="mb-1 text-white">Main Balance</p>
                                    <h2 class="fs-36 text-white mb-sm-4 mb-3" th:text="${balance}" id="mainBalance">$673,412.66</h2>
                                    <div class="d-flex align-items-center justify-content-between mb-sm-5 mb-3">
                                        <p></p>
                                        <h4 class="fs-20 text-white mb-0">**** **** **** ****</h4>
                                    </div>
                                    <div class="d-flex">
                                        <div>
                                            <p class="fs-14 mb-1 text-white op6">CARD HOLDER</p>
                                            <span th:text="${username}">Franklin Jr.</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="icon-container">
                                    <a><i class="fas fa-circle-info" aria-hidden="true"></i></a>
                                </div>
                            </div>
                        </div>

                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                            <!-- Buttons Section -->
                            <div class="d-flex align-items-center justify-content-between  mb-sm-5 ">
                                <a href="/OnePay/dashboard/top-up" class="btn light btn-success col-xl-5 col-lg-5 col-md-5 col-sm-5">
                                    <i class="fas fa-arrow-alt-circle-up"></i>
                                    Top Up
                                </a>
                                <a href="/OnePay/dashboard/withdraw" class="btn light btn-danger col-xl-5 col-lg-5 col-md-5 col-sm-5">
                                    <i class="fas fa-arrow-alt-circle-down"></i>
                                    Withdraw
                                </a>
                            </div>
                        </div>

                        <div class="col-xl-12">
                            <div class="card">
                                <div class="card-header d-sm-flex d-block border-0 pb-0">
                                    <div class="pr-3 mb-sm-0 mb-3 me-auto">
                                        <h4 class="fs-20 text-black mb-1">Quick Transfer</h4>
                                        <span class="fs-12">Your saved Recipients</span>
                                    </div>
                                    <span class="fs-24 text-black font-w600" th:text="${balance}">$56,772.38</span>
                                </div>
                                <div class="card-body">
                                    <div id="recipients-data">
                                        <div style="display: block;"   class="user-container d-flex justify-content-between align-items-center">
                                            <div class="add-btn">
                                                <button class="btn btn-primary" id="add-button">
                                                    <i class="fas fa-plus"></i> Add
                                                </button>
                                            </div>
                                            <div class="user-item">
                                                <div class="logo-box"></div>
                                                <h6 class="fs-16 mb-0">
                                                    <a class="recipient-name text-black">David</a>
                                                </h6>
                                                <span class="fs-12"> <i class = "fas fa-phone"></i> 2345 6344</span>
                                            </div>


                                            <div class="user-item">
                                                <div class="logo-box"></div>
                                                <h6 class="fs-16 mb-0">
                                                    <a class="recipient-name text-black">Rachel Li</a>
                                                </h6>
                                                <span class="fs-12"><i class = "fas fa-phone"></i> 1234 2313</span>
                                            </div>

                                            <div class="user-item">
                                                <div class="logo-box"></div>
                                                <h6 class="fs-16 mb-0">
                                                    <a class="recipient-name text-black">Amy</a>
                                                </h6>
                                                <span class="fs-12"><i class = "fas fa-phone"></i> 1222 2212</span>
                                            </div>

                                            <div class="user-item">
                                                <div class="logo-box"></div>
                                                <h6 class="fs-16 mb-0">
                                                    <a class="recipient-name text-black">Red</a>
                                                </h6>
                                                <span class="fs-12"><i class = "fas fa-phone"></i> 3333 4532</span>
                                            </div>

                                            <div class="user-item">
                                                <div class="logo-box"></div>
                                                <h6 class="fs-16 mb-0">
                                                    <a class="recipient-name text-black">Michel</a>
                                                </h6>
                                                <span class="fs-12"><i class = "fas fa-phone"></i> 7976 7989</span>
                                            </div>

                                            <div class="user-item">
                                                <div class="logo-box"></div>
                                                <h6 class="fs-16 mb-0">
                                                    <a class="recipient-name text-black">Lee Ri</a>
                                                </h6>
                                                <span class="fs-12"><i class = "fas fa-phone"></i> 2342 5656</span>
                                            </div>
                                        </div>
                                    </div>

                                    <span id="no-recipient" style="display: none;" class="mx-auto">No saved Recipients</span>


                                    <!-- Add Recipient Form Content -->
                                    <div id="form-content" style="display: none" >
                                        <form>
                                            <div class="form-group">
                                                <label for="recipient-name-input" class="fs-18 text-black font-w500">Enter Name:</label>
                                                <input type="text" class="form-control col-xl-12" id="recipient-name-input" placeholder="Enter Recipient Name" required>
                                            </div>

                                            <div class="form-group">
                                                <label for="phone-number-input" class="fs-18 text-black font-w500">Enter Phone Number:</label>
                                                <input type="number" class="form-control" id="phone-number-input" placeholder="Enter Phone Number" required>
                                            </div>

                                            <div class="d-flex justify-content-between">
                                                <button type="button" class="btn btn-secondary" id="back-button">Back</button>
                                                <button type="button" class="btn btn-primary" id="save-button">Save</button>
                                            </div>
                                        </form>
                                    </div>


                                    <form id="recipient-transfer">
                                        <div class="fs-12 form-group mb-0 row style-1 align-items-center" style="padding-top: 20px;">
                                            <div class="col-sm-3">
                                                <label class="fs-18 text-black font-w500">Amount</label>
                                            </div>
                                            <div class="col-sm-9">
                                                <div class="input-group">
                                                    <input placeholder="Enter Amount" id="amount-input" class="form-control col-sm-6" type="number" required disabled>
                                                    <div class="invalid-feedback">Money Amount is required.</div>
                                                    <div class="input-group-append">
                                                        <button class="btn btn-primary rounded "
                                                                type="submit" id="transfer-btn" disabled>TRANSFER NOW
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <div id="recipient-result-msg" class="mt-3"></div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-xl-6">
                    <div class="row">
                        <div class="col-xl-12">
                            <div class="card">
                                <div class="card-body ">
<!--                                    class="text-black font-w600 mb-0"-->
                                    <h2 class="text-black font-w600 fs-20 text-black mb-1"  >Money Transfer</h2>
                                    <form id="transfer-form">
                                        <!-- Receiver Wallet ID -->
                                        <div class="form-group">
                                            <label for="receiverMobileNumber" class="fs-18 text-black font-w500"  style="margin-top: 20px;" >Receiver Mobile Number:</label>
                                            <input type="number"  style="background-color: #f4f0ec; color:black" class="form-control" id="receiverMobileNumber" placeholder="Enter Receiver Mobile Number" required>
                                            <div class="invalid-feedback">Receiver Mobile Number is required and must valid.</div>
                                        </div>

                                        <!-- Amount -->
                                        <div class="form-group">
                                            <label for="amount" class="fs-18 text-black font-w500">Amount to Transfer:</label>
                                            <input type="number"  style="background-color: #f4f0ec; color:black" class="form-control" id="amount" step="0.01" placeholder="Enter Amount" required>
                                            <div class="invalid-feedback" >Amount is required and must be greater than 0.</div>
                                        </div>

                                        <!-- Submit Button -->


                                        <button type="submit" class="btn btn-primary">
                                            <span class="transfer-icon">
                                                <i class="fas fa-exchange-alt"></i>
                                            </span>
                                            <span class="text">Transfer Now</span>
                                        </button>
                                    </form>
                                    <div id="resultMessage" class="mt-3"></div>
                                </div>
                            </div>
                        </div>

                        <div class="col-xl-12">
                            <div class="card">
                                <div class="card-header d-block d-sm-flex border-0">
                                    <div class="me-3">
                                        <h4 class="fs-20 text-black">Previous Transactions</h4>
                                    </div>
                                </div>
                                <div class="card-body tab-content p-0">
                                    <div id="errorMessage" class="error" th:text="${errorMessage}"></div>
                                    <div class="table-responsive">
                                        <table id="transactionTable" class="table table-responsive-md card-table previous-transactions">
                                            <thead>
                                            <tr>
                                                <td class="fs-16 font-w600 mb-0">No</td>
                                                <td class="fs-16 font-w600 mb-0">Type</td>
                                                <td class="fs-16 font-w600 mb-0">Amount</td>
                                                <td class="fs-16 font-w600 mb-0">Date</td>
                                                <td class="fs-16 font-w600 mb-0">Status</td>
                                                <td class="fs-16 font-w600 mb-0">Description</td>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <td>Empty</td>
                                                <td>Unknown</td>
                                                <td>N/A</td>
                                                <td>N/A</td>
                                                <td>Unknown</td>
                                                <td>No description available</td>
                                            <!-- Transaction rows will be dynamically inserted here -->
                                            </tbody>
                                        </table>
                                    </div>

                                    <!-- Pagination controls will be added here -->
                                    <div id="paginationControls" class="dataTables_paginate">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--**********************************
        Content body end
    ***********************************-->

    <!--**********************************
        Footer start
    ***********************************-->
    <div class="footer">
        <div class="copyright">
            <p>Copyright Â© Designed &amp; Developed by FYP-24-S3-14</a>
                <span class="current-year">2024</span></p>
        </div>
    </div>
    <!--**********************************
        Footer end
    ***********************************-->

</div>
<!--**********************************
    Main wrapper end
***********************************-->

<!--**********************************
    Scripts
***********************************-->
<!-- Required vendors -->
<script th:src="@{/dashboardassets/vendor/global/global.min.js}"></script>
<script th:src="@{/dashboardassets/vendor/bootstrap-select/dist/js/bootstrap-select.min.js}"></script>
<script th:src="@{/dashboardassets/vendor/chart-js/chart.bundle.min.js}"></script>
<script th:src="@{/dashboardassets/vendor/owl-carousel/owl.carousel.js}"></script>

<!-- Chart piety plugin files -->
<script th:src="@{/dashboardassets/vendor/peity/jquery.peity.min.js}"></script>

<!-- Apex Chart -->
<script th:src="@{/dashboardassets/vendor/apexchart/apexchart.js}"></script>

<!-- Dashboard 1 -->
<script th:src="@{/dashboardassets/js/dashboard/dashboard-1.js}"></script>

<script th:src="@{/dashboardassets/js/custom.min.js}"></script>
<script th:src="@{/dashboardassets/js/deznav-init.js}"></script>


<script>
    function carouselReview() {
        /*  testimonial one function by = owl.carousel.js */
        jQuery('.testimonial-one').owlCarousel({
            loop: true,
            margin: 10,
            autoplay: true,
            nav: false,
            center: true,
            rtl: true,
            dots: false,
            navText: ['<i class="fas fa-caret-left"></i>', '<i class="fas fa-caret-right"></i>'],
            responsive: {
                0: {
                    items: 2
                },
                400: {
                    items: 3
                },
                700: {
                    items: 5
                },
                991: {
                    items: 6
                },

                1200: {
                    items: 4
                },
                1600: {
                    items: 5
                }
            }
        })
    }

    jQuery(window).on('load', function () {
        setTimeout(function () {
            carouselReview();

        }, 1000);
    });

    jQuery(document).ready(function(){
        setTimeout(function(){
            dezSettingsOptions.version = 'light';
            new dezSettings(dezSettingsOptions);

            setCookie('version','light');

        },1500)
    });


    document.addEventListener('DOMContentLoaded', function () {
        // Select the collapse elements and chevrons
        var accountCollapseElement = document.querySelector('#accountSubmenu');
        var transferCollapseElement = document.querySelector('#transferSubmenu');
        var walletCollapseElement = document.querySelector('#walletSubmenu');

        var accountChevron = document.querySelector('a[data-bs-target="#accountSubmenu"] .dropdown-chevron');
        var transferChevron = document.querySelector('a[data-bs-target="#transferSubmenu"] .dropdown-chevron');
        var walletChevron = document.querySelector('a[data-bs-target="#walletSubmenu"] .dropdown-chevron');

        var collapsibles = [
            { element: accountCollapseElement, chevron: accountChevron },
            { element: transferCollapseElement, chevron: transferChevron },
            { element: walletCollapseElement, chevron: walletChevron }
        ];

        function setupCollapseListener(collapseElement, chevron) {
            collapseElement.addEventListener('show.bs.collapse', function () {
                // Close other collapsibles and reset chevrons
                collapsibles.forEach(function (item) {
                    if (item.element !== collapseElement) {
                        var bsCollapse = new bootstrap.Collapse(item.element, { toggle: false });
                        bsCollapse.hide();
                        item.chevron.classList.remove('fa-chevron-down');
                        item.chevron.classList.add('fa-chevron-right');
                    }
                });

                // Update the chevron of the currently opened collapsible
                chevron.classList.remove('fa-chevron-right');
                chevron.classList.add('fa-chevron-down');
            });

            collapseElement.addEventListener('hide.bs.collapse', function () {
                chevron.classList.remove('fa-chevron-down');
                chevron.classList.add('fa-chevron-right');
            });
        }

        // Initialize listeners for each collapsible
        collapsibles.forEach(function (item) {
            if (item.chevron && item.element) {
                setupCollapseListener(item.element, item.chevron);
            }
        });


    });
</script>

<script>

    // transfer money for both quick transfer and normal transfer
    document.addEventListener('DOMContentLoaded', function () {
        // Reusable function to handle form submissions
        function handleFormSubmission(formId, receiverNum, amountValue) {
            document.getElementById(formId).addEventListener('submit', function (event) {
                event.preventDefault(); // Prevent default form submission

                let isValid= true;
                // const amount = document.getElementById(amountValue).value;
                // const receiverMobileNumber = document.getElementById(receiverNum).value;

                // Get input values
                let receiverMobileNumber;
                // For now {Need to change later}
                if(formId === "recipient-transfer"){
                    receiverMobileNumber = receiverNum;

                } else {
                    receiverMobileNumber = document.getElementById(receiverNum).value;
                }

                const amount = document.getElementById(amountValue).value;
                console.log(formId , receiverNum, amountValue);
                console.log("show: " , receiverMobileNumber);

                // Basic validation
                // Only transfer form has the phone number input. For now
                if(formId === "transfer-form") {
                    if (!receiverMobileNumber || isNaN(receiverMobileNumber) || receiverMobileNumber <= 0) {
                        document.getElementById(receiverNum).classList.add('is-invalid');
                        isValid = false;
                    } else {
                        document.getElementById(receiverNum).classList.remove('is-invalid');
                    }
                }


                if (!amount || isNaN(amount) || parseFloat(amount) <= 0) {
                    document.getElementById(amountValue).classList.add('is-invalid');
                    isValid = false;
                } else {
                    document.getElementById(amountValue).classList.remove('is-invalid');
                }

                // If form is not valid, stop submission
                if (!isValid) {
                    return;
                }

                // Prepare data to send to the backend
                const requestData = {
                    receiverMobileNumber: receiverMobileNumber,
                    amount: amount
                };

                // Send the data to the backend using fetch
                fetch('/OnePay/transfer', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestData)
                })
                    .then(response => response.json())
                    .then(data => {

                        if(formId === "recipient-transfer"){

                            if (data.status === 'success') {
                                document.getElementById('recipient-result-msg').innerHTML =
                                    '<div class="alert alert-success">' + data.message + '</div>';

                                // Clear the input field
                                document.getElementById('amount-input').value = '';
                            } else {
                                console.log('Recipient-transfer failed during transfer:', data.message);
                                document.getElementById('recipient-result-msg').innerHTML =
                                    '<div class="alert alert-danger">Transfer failed: ' + data.message + '</div>';
                            }
                        } else {
                            if (data.status === 'success') {
                                console.log('Transfer Successful during transfer:', data.message);
                                document.getElementById('resultMessage').innerHTML =
                                   '<div class="alert alert-success">' + data.message + '</div>';

                                // Clear the input field
                                document.getElementById('receiverMobileNumber').value = '';
                                document.getElementById('amount').value = '';
                            } else {
                                console.log('Transfer failed during transfer:', data.message);
                                document.getElementById('resultMessage').innerHTML =
                                    '<div class="alert alert-danger">Transfer failed: ' + data.message + '</div>';
                            }
                        }
                    })
                    .catch(error => {
                        console.error('Error during transfer:', error);
                        if(formId === "recipient-transfer"){
                            document.getElementById('recipient-result-msg').innerHTML =
                                '<div class="alert alert-danger">An error occurred. Please try again.</div>';
                        }else {
                            document.getElementById('resultMessage').innerHTML =
                                '<div class="alert alert-danger">An error occurred. Please try again.</div>';
                        }
                    });
            });
        }

        // Attach form submission handlers to both transfer forms
        handleFormSubmission('transfer-form', 'receiverMobileNumber', 'amount');
        // mobile number is sample for this one
        handleFormSubmission('recipient-transfer', 12345678, 'amount-input');
    });


    // Function to generate initials for all recipient items
    function generateLogosFromNames() {
        const recipientNames = document.querySelectorAll('.recipient-name');
        const logoBoxes = document.querySelectorAll('.logo-box');

        recipientNames.forEach((nameElement, index) => {
            const recipientName = nameElement.textContent.trim(); // Get user's name
            const nameParts = recipientName.split(' ');
            let initials = '';

            if (nameParts.length === 1) {
                initials = nameParts[0].charAt(0); // If it's a single name, take the first letter
            } else {
                // If multiple parts, take the first letter of the first two parts
                initials = nameParts[0].charAt(0) + nameParts[1].charAt(0);
            }

            // Set the initials in the corresponding logo-box (matching by index)
            logoBoxes[index].textContent = initials.toUpperCase(); // Set initials and convert to uppercase
        });
    }

    // Call the function when the page loads to generate the logos for recipients
    window.onload = generateLogosFromNames;

    // adding recipients
    document.getElementById('add-button').addEventListener('click', function() {
        document.getElementById('recipients-data').style.display = 'none';
        document.getElementById('form-content').style.display = 'block';

        const amountInput = document.getElementById('amount-input');
        const transferButton = document.getElementById('transfer-btn');
        amountInput.disabled = true;
        transferButton.disabled = true;

        const userItems = document.querySelectorAll('.user-item');
        userItems.forEach(item => {
            item.classList.remove('selected');
        });

    })

    // back button from adding recipient
    document.getElementById('back-button').addEventListener('click', function() {
        document.getElementById('form-content').style.display = 'none';   // Hide form content
        document.getElementById('recipients-data').style.display = 'block'; // Show initial content
    });


    // save button from adding recipient
    document.getElementById('save-button').addEventListener('click', function() {
        const recipientName = document.getElementById('recipient-name-input').value;
        const phoneNumber = document.getElementById('phone-number-input').value;

        if (recipientName && phoneNumber) {
            // For demonstration, we'll log the data and switch back to the initial view
            console.log('Recipient Name:', recipientName);
            console.log('Phone Number:', phoneNumber);

            // Reset form
            document.getElementById('recipient-name-input').value = '';
            document.getElementById('phone-number-input').value = '';

            // Hide form content and show the initial content
            document.getElementById('form-content').style.display = 'none';
            document.getElementById('recipients-data').style.display = 'block';
        } else {
            alert('Please fill in both fields');
        }
    });

    document.addEventListener('DOMContentLoaded', function () {
        const userItems = document.querySelectorAll('.user-item');
        const amountInput = document.getElementById('amount-input');
        const transferButton = document.getElementById('transfer-btn');
        let selectedUser = null;

        userItems.forEach(item => {
            item.addEventListener('click', function () {
                // Remove the 'selected' class from previously selected item
                if (selectedUser) {
                    selectedUser.classList.remove('selected');
                }

                // Mark the current user-item as selected
                this.classList.add('selected');
                selectedUser = this;

                // Enable the amount input and Transfer Now button
                amountInput.disabled = false;
                transferButton.disabled = false;
            });
        });
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', fetchTransactionHistory);

    let currentPage = 1; // Track the current page
    const rowsPerPage = 7; // Define how many rows to show per page

    function fetchTransactionHistory() {
        const errorMessage = document.getElementById('errorMessage');
        const transactionTable = document.getElementById('transactionTable');
        const tableBody = transactionTable.querySelector('tbody');
        const paginationContainer = document.getElementById('paginationControls'); // For page navigation controls

        // Clear previous states
        errorMessage.textContent = '';
        tableBody.innerHTML = '';
        paginationContainer.innerHTML = '';
        transactionTable.style.display = 'none';

        // Fetch transaction history
        fetch('/OnePay/fetchHistory', {
            method: 'GET',
            credentials: 'include'
        })
            .then(response => {
                if (!response.ok) {
                    return response.text().then(text => {
                        throw new Error(text);
                    });
                }
                return response.json();
            })
            .then(data => {
                if (Array.isArray(data) && data.length > 0) {
                    transactionTable.style.display = 'table';
                    displayPage(data, currentPage); // Display the first page

                    if(data.length > 7 ){
                        const totalPages = Math.ceil(data.length / rowsPerPage); // Calculate total pages
                        createPaginationControls(totalPages, data); // Create page navigation controls
                    }

                } else {
                    errorMessage.textContent = 'No transactions found.';
                }
            })
            .catch(error => {
                errorMessage.textContent = `Error: ${error.message}`;
            });
    }

    function displayPage(data, page) {
        const transactionTable = document.getElementById('transactionTable');
        const tableBody = transactionTable.querySelector('tbody');

        // Clear current rows
        tableBody.innerHTML = '';

        // Calculate the start and end index for the current page
        const start = (page - 1) * rowsPerPage;
        const end = start + rowsPerPage;

        // Get the rows for the current page
        const pageData = data.slice(start, end);

        let counter = start + 1; // Row numbers should reflect the full dataset

        pageData.forEach(transaction => {
            const row = document.createElement('tr');
            row.classList.add('custom-row'); // Add custom row class for styling

            // Determine the sign for the amount based on transaction type
            let formattedAmount = transaction.amount || 'N/A';
            formattedAmount = formattedAmount !== 'N/A' ? `$${formattedAmount}` : 'N/A';

            if (transaction.transactionType === 'TRANSFER') {
                formattedAmount = `-${formattedAmount}`; // Add minus for transfer
            } else if (transaction.transactionType === 'DEPOSIT') {
                formattedAmount = `+${formattedAmount}`; // Add plus for deposit
            }

            row.innerHTML = `
            <td class="fs-16 font-w600 mb-0">
                <a class="text-black">${counter++}</a> <!-- Increment counter for each row -->
            </td>
            <td>${transaction.transactionType || 'Unknown'}</td>
            <td class="fs-16 text-black font-w500">${formattedAmount}</td>
            <td class="fs-16 text-black font-w400 mb-0">
                ${transaction.timestamp ? new Date(transaction.timestamp).toLocaleString() : 'N/A'}
            </td>
            <td class="${transaction.status === 'COMPLETED' ? 'text-success' :
                transaction.status === 'PENDING' ? 'text-warning' :
                transaction.status === 'FAILED' ? 'text-danger' : 'text-muted'}
                fs-16 font-w500 d-block">
                ${transaction.status || 'Unknown'}
            </td>
            <td class="fs-14 text-start">
                <span >${transaction.description || 'No description available'}</span>
            </td>
        `;
            tableBody.appendChild(row);
        });
    }

    function createPaginationControls(totalPages, data) {
        const paginationContainer = document.getElementById('paginationControls');

        // Clear previous pagination controls
        paginationContainer.innerHTML = '';

        // Apply container styles
        paginationContainer.style.cssText = `
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 5px;
        margin: 20px 0;
    `;

        // Previous button
        const prevButton = document.createElement('a');
        prevButton.textContent = 'Previous';
        prevButton.href = '#'; // Make it clickable
        prevButton.classList.add('paginate_button', 'previous');
        prevButton.style.cssText = `
        color: ${currentPage === 1 ? '#ccc' : '#1EAAE7'};
        background: ${currentPage === 1 ? '#f5f5f5' : 'transparent'};
        padding: 10px 15px;
        border-radius: 0.5rem;
        border: 1px solid #ddd;
        text-decoration: none;
        cursor: ${currentPage === 1 ? 'not-allowed' : 'pointer'};
    `;
        if (currentPage === 1) {
            prevButton.classList.add('disabled'); // Add disabled class if on the first page
        }
        prevButton.addEventListener('click', (event) => {
            event.preventDefault();
            if (currentPage > 1) {
                currentPage--;
                displayPage(data, currentPage); // Show the previous page
                createPaginationControls(totalPages, data); // Update pagination controls
            }
        });
        paginationContainer.appendChild(prevButton);

        // Page number buttons
        const pageSpan = document.createElement('span'); // Wrap page numbers in a span
        pageSpan.style.cssText = `
        display: flex;
        gap: 5px;
    `;
        for (let page = 1; page <= totalPages; page++) {
            const pageButton = document.createElement('a');
            pageButton.textContent = page;
            pageButton.href = '#';
            pageButton.classList.add('paginate_button');
            pageButton.style.cssText = `
            color: ${page === currentPage ? '#fff' : '#1EAAE7'};
            background: ${page === currentPage ? '#1EAAE7' : 'transparent'};
            padding: 10px 15px;
            border-radius: 0.5rem;
            border: 1px solid #ddd;
            text-decoration: none;
            cursor: pointer;
        `;
            if (page === currentPage) {
                pageButton.classList.add('current'); // Highlight the current page
            }
            pageButton.addEventListener('click', (event) => {
                event.preventDefault();
                currentPage = page;
                displayPage(data, currentPage); // Show the selected page
                createPaginationControls(totalPages, data); // Update pagination controls
            });
            pageSpan.appendChild(pageButton);
        }
        paginationContainer.appendChild(pageSpan);

        // Next button
        const nextButton = document.createElement('a');
        nextButton.textContent = 'Next';
        nextButton.href = '#';
        nextButton.classList.add('paginate_button', 'next');
        nextButton.style.cssText = `
        color: ${currentPage === totalPages ? '#ccc' : '#1EAAE7'};
        background: ${currentPage === totalPages ? '#f5f5f5' : 'transparent'};
        padding: 10px 15px;
        border-radius: 0.5rem;
        border: 1px solid #ddd;
        text-decoration: none;
        cursor: ${currentPage === totalPages ? 'not-allowed' : 'pointer'};
    `;
        if (currentPage === totalPages) {
            nextButton.classList.add('disabled'); // Add disabled class if on the last page
        }
        nextButton.addEventListener('click', (event) => {
            event.preventDefault();
            if (currentPage < totalPages) {
                currentPage++;
                displayPage(data, currentPage); // Show the next page
                createPaginationControls(totalPages, data); // Update pagination controls
            }
        });
        paginationContainer.appendChild(nextButton);
    }
</script>
</body>
</html>